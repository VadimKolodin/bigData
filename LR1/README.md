# Лабораторная работа 1

### Задание
1.	Найти велосипед с максимальным временем пробега.
2.	Найти наибольшее геодезическое расстояние между станциями.
3.	Найти путь велосипеда с максимальным временем пробега через станции.
4.	Найти количество велосипедов в системе.
5.	Найти пользователей, потративших на поездки более 3 часов.
### Решение
##### Найти велосипед с максимальным временем пробега
![image](https://github.com/VadimKolodin/bigData/assets/105828231/f8d74cb7-6418-4104-b544-1ec61a25cf61)
С помощью метода map из исходной выборки поездок получаем кортеж из идентификатора поездки и ее длительности, затем применяем функцию редукции для каждого идентификатора отдельно. Далее применяем функцию редукции всех данных, выбирая кортежи с бОльшим значением временем пробега, таким образом получая велосипед с самым большим значением, в итоге выводим идентификатор велосипеда.
##### Найти наибольшее геодезическое расстояние между станциями
![image](https://github.com/VadimKolodin/bigData/assets/105828231/d4dbede4-a6c5-47b1-88cc-def55827fbf6)
Для начала была реализована отдельная функция dist для подсчета расстояния между двумя станциями с помощью их долготы и широты. Далее получаем декартово произведение множества станций самим с собой, после чего убираем пары, где станция находится в паре с собой же. Далее после чего применяем вышеописанную функцию для подсчета расстояния между парами станций. После чего находим максимум из расстояний.
##### Найти путь велосипеда с максимальным временем пробега через станции
![image](https://github.com/VadimKolodin/bigData/assets/105828231/1e81928d-4773-402c-a22a-4e012fada8a5)
Описание реализации: с помощью фильтрации отбираем только те поездки, идентификатор велосипеда которых совпадает с ранее найденным. Далее сортируем записи по началу времени поездки (для восстановления хронологического порядка), далее отбираем конечную станцию каждой поездки и ее дубликаты.
##### Найти количество велосипедов в системе
![image](https://github.com/VadimKolodin/bigData/assets/105828231/045f50af-7886-4b6b-8206-43cd7c91143b)
Описание реализации: преобразуем каждую запись в идентификатор велосипеда, затем убираем все повторяющиеся записи и находим их количество.
##### Найти пользователей, потративших на поездки более 3 часов
![image](https://github.com/VadimKolodin/bigData/assets/105828231/aa66db25-7dff-446d-94aa-9970c23f40d1)
Сначала преобразовываем каждую запись в кортеж из почтового индекса пользователя и длительности поездки, для каждого пользователя редуцируем время поездки, тем самым получая все время пользования системой каждым пользователем, фильтруем пользователей, которые ездили меньше 3х часов и отбираем из каждой записи только почтовый индекс пользователя.
