# Лабораторная работа 2

### Задание
Сформировать отчёт с информацией о 10 наиболее популярных языках программирования по итогам года за период с 2010 по 2020 годы. Отчёт будет отражать динамику изменения популярности языков программирования и представлять собой набор таблиц "топ-10" для каждого года.
Получившийся отчёт сохранить в формате Apache Parquet.
Для выполнения задания вы можете использовать любую комбинацию Spark API: RDD API, Dataset API, SQL API

### Решение

Лабораторная работа была реализована на языке Python с использованием сервера mapr.
На рисунках выше показана реализация чтения исходных данных, а именно, чтение файлов с расширениями csv и xml. Для этого был использован метод read для формата csv и xml соответственно, также продемонстрированы примеры из этих файлов (первые 10 записей в файле с языками программирования, без учета 0 строки-заголовка, первый пост из файла posts_sample.xml)

Рисунки выше содержат реализацию основного задания – составления отчета о топ-10 языках программирования за каждый год.
Описание реализации: из выборки постов получаются года публикации, чтобы получить диапазон значений лет, за которые можно сформировать отчет; далее для каждого года из изначальной выборки фильтруются те строки, где можно получить тэг, содержащий язык; после чего все строки подвергаются преобразованию в объекты с помощью функции initPost и убираются строки, где год публикации не соответствует отчетному; далее получаются пары значений из идентификатора языка и кол-ва просмотров поста; после чего применяется функция редукции по кол-ву просмотров постов для каждого языка. Далее записи сортируются по кол-ву просмотров и преобразовываются в Dataframe. Из получившихся данных выбираются колонки, соответствующие названию языка (с помощью ранее составленного списка языков) и кол-ва просмотров, берутся первые 10 значений. Итоговые данные складывается в словарь. Наконец, содержимое словаря выводится и сохраняется в файлы формата parquet:

